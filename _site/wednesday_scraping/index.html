<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="How to automate data extraction from the web with Python">

<title>Coding Fundamentals for Humanists - Web scraping</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="..//img/dhsi_logo.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../img/dhsi_logo.png" alt="DHSI logo" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../monday/index.html"> 
<span class="menu-text">Command line</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../tuesday/index.html"> 
<span class="menu-text">Python course</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../wednesday_scraping/index.html" aria-current="page"> 
<span class="menu-text">Web scraping</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../wednesday_api/index.html"> 
<span class="menu-text">API querying</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../thursday/index.html"> 
<span class="menu-text">On your own</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../friday/index.html"> 
<span class="menu-text">Presentations</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://etherpad.wikimedia.org/p/dhsi24" target="_blank"> 
<span class="menu-text">Live notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Web scraping</h1>
                  <div>
        <div class="description">
          <p>How to automate data extraction from the web with Python</p>
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title"><em>On this page:</em></h2>
   
  <ul>
  <li><a href="#html-and-css" id="toc-html-and-css" class="nav-link active" data-scroll-target="#html-and-css">HTML and CSS</a></li>
  <li><a href="#web-scrapping" id="toc-web-scrapping" class="nav-link" data-scroll-target="#web-scrapping">Web scrapping</a></li>
  <li><a href="#example-for-this-workshop" id="toc-example-for-this-workshop" class="nav-link" data-scroll-target="#example-for-this-workshop">Example for this workshop</a></li>
  <li><a href="#lets-look-at-the-sites" id="toc-lets-look-at-the-sites" class="nav-link" data-scroll-target="#lets-look-at-the-sites">Let’s look at the sites</a></li>
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link" data-scroll-target="#load-packages">Load packages</a></li>
  <li><a href="#send-request-to-the-main-site" id="toc-send-request-to-the-main-site" class="nav-link" data-scroll-target="#send-request-to-the-main-site">Send request to the main site</a></li>
  <li><a href="#explore-the-raw-data" id="toc-explore-the-raw-data" class="nav-link" data-scroll-target="#explore-the-raw-data">Explore the raw data</a></li>
  <li><a href="#parse-the-data" id="toc-parse-the-data" class="nav-link" data-scroll-target="#parse-the-data">Parse the data</a></li>
  <li><a href="#test-run" id="toc-test-run" class="nav-link" data-scroll-target="#test-run">Test run</a>
  <ul>
  <li><a href="#identify-relevant-markers" id="toc-identify-relevant-markers" class="nav-link" data-scroll-target="#identify-relevant-markers">Identify relevant markers</a></li>
  <li><a href="#extract-test-url" id="toc-extract-test-url" class="nav-link" data-scroll-target="#extract-test-url">Extract test URL</a></li>
  <li><a href="#send-request-to-test-url" id="toc-send-request-to-test-url" class="nav-link" data-scroll-target="#send-request-to-test-url">Send request to test URL</a></li>
  <li><a href="#get-data-for-test-url" id="toc-get-data-for-test-url" class="nav-link" data-scroll-target="#get-data-for-test-url">Get data for test URL</a></li>
  </ul></li>
  <li><a href="#full-run" id="toc-full-run" class="nav-link" data-scroll-target="#full-run">Full run</a>
  <ul>
  <li><a href="#extract-all-urls" id="toc-extract-all-urls" class="nav-link" data-scroll-target="#extract-all-urls">Extract all URLs</a></li>
  <li><a href="#extract-data-from-each-page" id="toc-extract-data-from-each-page" class="nav-link" data-scroll-target="#extract-data-from-each-page">Extract data from each page</a></li>
  </ul></li>
  <li><a href="#store-results-in-dataframe" id="toc-store-results-in-dataframe" class="nav-link" data-scroll-target="#store-results-in-dataframe">Store results in DataFrame</a></li>
  <li><a href="#save-results-to-file" id="toc-save-results-to-file" class="nav-link" data-scroll-target="#save-results-to-file">Save results to file</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div class="topdef">
<p><strong>Date:</strong><br>
Wednesday June 12, 2024</p>
<p><strong>Time:</strong><br>
9am–noon</p>
<p><strong>Instructor:</strong><br>
Marie-Hélène Burle (Simon Fraser University)</p>
</div>
<p><br></p>
<p><em>The internet is a trove of information. A lot of it is publicly available and thus suitable for use in research. Extracting that information and putting it in an organized format for analysis can however, be extremely tedious.</em></p>
<p><em>Web scraping tools allow to automate parts of that process and Python is a popular language for the task.</em></p>
<p><em>In this workshop, I will guide you through a simple example using the package <a href="https://beautiful-soup-4.readthedocs.io/en/latest/">Beautiful Soup</a>.</em></p>
<section id="html-and-css" class="level2">
<h2 class="anchored" data-anchor-id="html-and-css">HTML and CSS</h2>
<p><a href="https://en.wikipedia.org/wiki/HTML">HyperText Markup Language</a> (HTML) is the standard markup language for websites: it encodes the information related to the formatting and structure of webpages. Additionally, some of the customization can be stored in <a href="https://en.wikipedia.org/wiki/CSS">Cascading Style Sheets</a> (CSS) files.</p>
<p>HTML uses tags of the form:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">some_tag</span><span class="dt">&gt;</span>Your content<span class="dt">&lt;/</span><span class="kw">some_tag</span><span class="dt">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Some tags have attributes:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">some_tag</span><span class="ot"> attribute_name</span><span class="op">=</span><span class="st">"attribute value"</span><span class="dt">&gt;</span>Your content<span class="dt">&lt;/</span><span class="kw">some_tag</span><span class="dt">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="example">
<p>Examples:</p>
</div>
<p>Site structure:</p>
<ul>
<li><code>&lt;h2&gt;This is a heading of level 2&lt;/h2&gt;</code></li>
<li><code>&lt;p&gt;This is a paragraph&lt;/p&gt;</code></li>
</ul>
<p>Formatting:</p>
<ul>
<li><code>&lt;b&gt;This is bold&lt;/b&gt;</code></li>
<li><code>&lt;a href="https://some.url"&gt;This is the text for a link&lt;/a&gt;</code></li>
</ul>
</section>
<section id="web-scrapping" class="level2">
<h2 class="anchored" data-anchor-id="web-scrapping">Web scrapping</h2>
<p>Web scraping is a general term for a set of tools which allow for the extraction of data from the web automatically.</p>
<p>While most of the data on the internet is publicly available, it is illegal to scrape some sites and you should always look into the policy of a site before attempting to scrape it. Some sites will also block you if you submit too many requests in a short amount of time, so remember to scrape responsibly.</p>
</section>
<section id="example-for-this-workshop" class="level2">
<h2 class="anchored" data-anchor-id="example-for-this-workshop">Example for this workshop</h2>
<p>We will use <a href="https://trace.tennessee.edu/utk_graddiss/index.html">a website</a> from the <a href="https://www.utk.edu/">University of Tennessee</a> containing a database of PhD theses from that university.</p>
<p>Our goal is to scrape data from this site to produce a dataframe with the date, major, and advisor for each dissertation.</p>
<div class="note">
<p>We will only do this for the first page which contains the links to the 100 most recent theses. If you really wanted to gather all the data, you would have to do this for all pages.</p>
</div>
</section>
<section id="lets-look-at-the-sites" class="level2">
<h2 class="anchored" data-anchor-id="lets-look-at-the-sites">Let’s look at the sites</h2>
<p>First of all, let’s have a close look at the websites we want to scrape to think carefully about what we want to do. Before starting to write code, it is always a good idea to think about what you are trying to achieve with your code.</p>
<p>To create a dataframe with the data for all the dissertations on that first page, we need to do two things:</p>
<ul>
<li><p>Step 1: from the <a href="https://trace.tennessee.edu/utk_graddiss/index.html">dissertations database first page</a>, we want to scrape the list of URLs for the dissertation pages.</p></li>
<li><p>Step 2: once we have the URLs, we want to scrape those pages too to get the date, major, and advisor for each dissertation.</p></li>
</ul>
</section>
<section id="load-packages" class="level2">
<h2 class="anchored" data-anchor-id="load-packages">Load packages</h2>
<p>Let’s load the packages that will make scraping websites with Python easier:</p>
<div id="46e0c919" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests                 <span class="co"># To download the html data from a site</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup   <span class="co"># To parse the html data</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time                     <span class="co"># To add a delay between each requests</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd             <span class="co"># To store our data in a DataFrame</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="send-request-to-the-main-site" class="level2">
<h2 class="anchored" data-anchor-id="send-request-to-the-main-site">Send request to the main site</h2>
<p>As mentioned above, our site is the <a href="https://trace.tennessee.edu/utk_graddiss/index.html">database of PhD dissertations from the University of Tennessee</a>.</p>
<p>Let’s create a string with the URL:</p>
<div id="dc5968f8" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://trace.tennessee.edu/utk_graddiss/index.html"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>First, we send a request to that URL and save the response in a variable called <code>r</code>:</p>
<div id="5628a384" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> requests.get(url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s see what our response looks like:</p>
<div id="bf2b9fc8" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>r</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>&lt;Response [200]&gt;</code></pre>
</div>
</div>
<p>If you look in the <a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">list of HTTP status codes</a>, you can see that a response with a code of <code>200</code> means that the request was successful.</p>
</section>
<section id="explore-the-raw-data" class="level2">
<h2 class="anchored" data-anchor-id="explore-the-raw-data">Explore the raw data</h2>
<p>To get the actual content of the response as unicode (text), we can use the <code>text</code> property of the response. This will give us the raw HTML markup from the webpage.</p>
<p>Let’s print the first 200 characters:</p>
<div id="006f0751" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(r.text[:<span class="dv">200</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;&lt;!-- inj yui3-seed: --&gt;&lt;script type='text/javascript' src='//cdnjs.cloudflare.com/ajax/libs/yui/3.6.0/yui/yui-min.js'&gt;&lt;/script&gt;&lt;script type='text/javascript' sr</code></pre>
</div>
</div>
</section>
<section id="parse-the-data" class="level2">
<h2 class="anchored" data-anchor-id="parse-the-data">Parse the data</h2>
<p>The package <a href="https://beautiful-soup-4.readthedocs.io/en/latest/">Beautiful Soup</a> transforms (parses) such HTML data into a parse tree, which will make extracting information easier.</p>
<p>Let’s create an object called <code>mainpage</code> with the parse tree:</p>
<div id="324597bc" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>mainpage <span class="op">=</span> BeautifulSoup(r.text, <span class="st">"html.parser"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="note">
<p><code>html.parser</code> is the name of the parser that we are using here. It is better to use a specific parser to get consistent results across environments.</p>
</div>
<p>We can print the beginning of the parsed result:</p>
<div id="36f735eb" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mainpage.prettify()[:<span class="dv">200</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
 &lt;head&gt;
  &lt;!-- inj yui3-seed: --&gt;
  &lt;script src="//cdnjs.cloudflare.com/ajax/libs/yui/3.6.0/yui/yui-min.js" type="text/javascript"&gt;
  &lt;/script&gt;
  &lt;script src="//ajax.g</code></pre>
</div>
</div>
<div class="note">
<p>The <code>prettify</code> method turns the BeautifulSoup object we created into a string (which is needed for slicing).</p>
</div>
<p>It doesn’t look any more clear to us, but it is now in a format the Beautiful Soup package can work with.</p>
<p>For instance, we can get the HTML segment containing the title with three methods:</p>
<ul>
<li>using the title tag name:</li>
</ul>
<div id="d68a1789" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mainpage.title</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>&lt;title&gt;
Doctoral Dissertations | Graduate School | University of Tennessee, Knoxville
&lt;/title&gt;</code></pre>
</div>
</div>
<ul>
<li>using <code>find</code> to look for HTML markers (tags, attributes, etc.):</li>
</ul>
<div id="05f3839b" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mainpage.find(<span class="st">"title"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>&lt;title&gt;
Doctoral Dissertations | Graduate School | University of Tennessee, Knoxville
&lt;/title&gt;</code></pre>
</div>
</div>
<ul>
<li>using <code>select</code> which accepts CSS selectors:</li>
</ul>
<div id="02e2b68c" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>mainpage.select(<span class="st">"title"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>[&lt;title&gt;
 Doctoral Dissertations | Graduate School | University of Tennessee, Knoxville
 &lt;/title&gt;]</code></pre>
</div>
</div>
<p><code>find</code> will only return the first element. <code>find_all</code> will return all elements. <code>select</code> will also return all elements. Which one you chose depends on what you need to extract. There often several ways to get you there.</p>
<p>Here are other examples of data extraction:</p>
<div id="1426ca36" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>mainpage.head</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>&lt;head&gt;&lt;!-- inj yui3-seed: --&gt;&lt;script src="//cdnjs.cloudflare.com/ajax/libs/yui/3.6.0/yui/yui-min.js" type="text/javascript"&gt;&lt;/script&gt;&lt;script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" type="text/javascript"&gt;&lt;/script&gt;&lt;!-- Adobe Analytics --&gt;&lt;script src="https://assets.adobedtm.com/4a848ae9611a/d0e96722185b/launch-d525bb0064d8.min.js" type="text/javascript"&gt;&lt;/script&gt;&lt;!-- Cookies --&gt;&lt;link href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css" rel="stylesheet" type="text/css"/&gt;&lt;script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js" type="text/javascript"&gt;&lt;/script&gt;&lt;script src="/assets/nr_browser_production.js" type="text/javascript"&gt;&lt;/script&gt;
&lt;!-- def.1 --&gt;
&lt;meta charset="utf-8"/&gt;
&lt;meta content="width=device-width" name="viewport"/&gt;
&lt;title&gt;
Doctoral Dissertations | Graduate School | University of Tennessee, Knoxville
&lt;/title&gt;
&lt;!-- FILE meta-tags.inc --&gt;&lt;!-- FILE: /srv/sequoia/main/data/assets/site/meta-tags.inc --&gt;
&lt;!-- FILE: meta-tags.inc (cont) --&gt;
&lt;!-- sh.1 --&gt;
&lt;link href="/ir-style.css" media="screen" rel="stylesheet" type="text/css"/&gt;
&lt;link href="/ir-custom.css" media="screen" rel="stylesheet" type="text/css"/&gt;
&lt;link href="ir-custom.css" media="screen" rel="stylesheet" type="text/css"/&gt;
&lt;link href="/ir-local.css" media="screen" rel="stylesheet" type="text/css"/&gt;
&lt;link href="ir-local.css" media="screen" rel="stylesheet" type="text/css"/&gt;
&lt;link href="/ir-print.css" media="print" rel="stylesheet" type="text/css"/&gt;
&lt;link href="/assets/floatbox/floatbox.css" rel="stylesheet" type="text/css"/&gt;
&lt;link href="/recent.rss" rel="alternate" title="Site Feed" type="application/rss+xml"/&gt;
&lt;link href="/favicon.ico" rel="shortcut icon" type="image/x-icon"/&gt;
&lt;!--[if IE]&gt;
&lt;link rel="stylesheet" href="/ir-ie.css" type="text/css" media="screen"&gt;
&lt;![endif]--&gt;
&lt;!-- JS --&gt;
&lt;script src="/assets/jsUtilities.js" type="text/javascript"&gt;&lt;/script&gt;
&lt;script src="/assets/footnoteLinks.js" type="text/javascript"&gt;&lt;/script&gt;
&lt;script src="/assets/scripts/yui-init.pack.js" type="text/javascript"&gt;&lt;/script&gt;
&lt;script src="/assets/scripts/bepress-init.pack.js" type="text/javascript"&gt;&lt;/script&gt;
&lt;script src="/assets/scripts/JumpListYUI.pack.js" type="text/javascript"&gt;&lt;/script&gt;
&lt;!-- end sh.1 --&gt;
&lt;script type="text/javascript"&gt;var pageData = {"page":{"environment":"prod","productName":"bpdg","language":"en","name":"ir_etd","businessUnit":"els:rp:st"},"visitor":{}};&lt;/script&gt;
&lt;/head&gt;</code></pre>
</div>
</div>
<div id="52f47edb" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>mainpage.a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>&lt;a data-scroll="" href="https://trace.tennessee.edu" title="Home"&gt;Home&lt;/a&gt;</code></pre>
</div>
</div>
<div id="8cfc7d41" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mainpage.find_all(<span class="st">"a"</span>)[:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>[&lt;a data-scroll="" href="https://trace.tennessee.edu" title="Home"&gt;Home&lt;/a&gt;,
 &lt;a data-scroll="" href="https://trace.tennessee.edu/do/search/advanced/" title="Search"&gt;&lt;i class="icon-search"&gt;&lt;/i&gt; Search&lt;/a&gt;,
 &lt;a data-scroll="" href="https://trace.tennessee.edu/communities.html" title="Browse"&gt;Browse Collections&lt;/a&gt;,
 &lt;a data-scroll="" href="/cgi/myaccount.cgi?context=utk_graddiss" title="My Account"&gt;My Account&lt;/a&gt;,
 &lt;a data-scroll="" href="https://trace.tennessee.edu/about.html" title="About"&gt;About&lt;/a&gt;]</code></pre>
</div>
</div>
<div id="79df5578" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>mainpage.select(<span class="st">"a"</span>)[:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>[&lt;a data-scroll="" href="https://trace.tennessee.edu" title="Home"&gt;Home&lt;/a&gt;,
 &lt;a data-scroll="" href="https://trace.tennessee.edu/do/search/advanced/" title="Search"&gt;&lt;i class="icon-search"&gt;&lt;/i&gt; Search&lt;/a&gt;,
 &lt;a data-scroll="" href="https://trace.tennessee.edu/communities.html" title="Browse"&gt;Browse Collections&lt;/a&gt;,
 &lt;a data-scroll="" href="/cgi/myaccount.cgi?context=utk_graddiss" title="My Account"&gt;My Account&lt;/a&gt;,
 &lt;a data-scroll="" href="https://trace.tennessee.edu/about.html" title="About"&gt;About&lt;/a&gt;]</code></pre>
</div>
</div>
</section>
<section id="test-run" class="level2">
<h2 class="anchored" data-anchor-id="test-run">Test run</h2>
<section id="identify-relevant-markers" class="level3">
<h3 class="anchored" data-anchor-id="identify-relevant-markers">Identify relevant markers</h3>
<p>The html code for this webpage contains the data we are interested in, but it is mixed in with a lot of HTML formatting and data we don’t care about. We need to extract the data relevant to us and turn it into a workable format.</p>
<p>The first step is to find the HTML markers that contain our data. One option is to use a web inspector or—even easier—the <a href="https://selectorgadget.com/">SelectorGadget</a>, a JavaScript bookmarklet built by <a href="https://andrewcantino.com/">Andrew Cantino</a>.</p>
<p>To use this tool, go to the <a href="https://selectorgadget.com/">SelectorGadget</a> website and drag the link of the bookmarklet to your bookmarks bar.</p>
<p>Now, go to the <a href="https://trace.tennessee.edu/utk_graddiss/index.html">dissertations database first page</a> and click on the bookmarklet in your bookmarks bar. You will see a floating box at the bottom of your screen. As you move your mouse across the screen, an orange rectangle appears around each element over which you pass.</p>
<p>Click on one of the dissertation links: now, there is an <code>a</code> appearing in the box at the bottom as well as the number of elements selected. The selected elements are highlighted in yellow. Those elements are links (in HTML, <code>a</code> tags define hyperlinks).</p>
<p>As you can see, all the links we want are selected. However, there are many other links we don’t want that are also highlighted. In fact, <em>all</em> links in the document are selected. We need to remove the categories of links that we don’t want. To do this, hover above any of the links we don’t want. You will see a red rectangle around it. Click on it: now all similar links are gone. You might have to do this a few times until only the relevant links (i.e.&nbsp;those that lead to the dissertation information pages) remain highlighted.</p>
<p>As there are 100 such links per page, the count of selected elements in the bottom floating box should be down to 100.</p>
<p>In the main section of the floating box, you can now see: <code>.article-listing a</code>. This means that the data we want are under the HTML elements <code>.article-listing a</code> (the class <code>.article-listing</code> and the tag <code>a</code>).</p>
</section>
<section id="extract-test-url" class="level3">
<h3 class="anchored" data-anchor-id="extract-test-url">Extract test URL</h3>
<p>It is a good idea to test things out on a single element before doing a massive batch scraping of a site, so let’s test our method for the first dissertation.</p>
<p>To start, we need to extract the first URL. Here, we will use the CSS selectors (we can get there using <code>find</code> too). <code>mainpage.select(".article-listing a")</code> would give us all the results (100 links):</p>
<div id="666af0c6" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(mainpage.select(<span class="st">".article-listing a"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>100</code></pre>
</div>
</div>
<p>To get the first one, we index it:</p>
<div id="7a801008" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>mainpage.select(<span class="st">".article-listing a"</span>)[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>&lt;a href="https://trace.tennessee.edu/utk_graddiss/8076"&gt;Understanding host-microbe interactions in maize kernel and sweetpotato leaf metagenomic profiles.&lt;/a&gt;</code></pre>
</div>
</div>
<p>The actual URL is contained in the <code>href</code> attribute. Attributes can be extracted with the <code>get</code> method:</p>
<div id="f929a2a2" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>mainpage.select(<span class="st">".article-listing a"</span>)[<span class="dv">0</span>].get(<span class="st">"href"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>'https://trace.tennessee.edu/utk_graddiss/8076'</code></pre>
</div>
</div>
<p>We now have our URL as a string. We can double-check that it is indeed a string:</p>
<div id="0398b36b" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(mainpage.select(<span class="st">".article-listing a"</span>)[<span class="dv">0</span>].get(<span class="st">"href"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>str</code></pre>
</div>
</div>
<p>This is exactly what we need to send a request to that site, so let’s create an object <code>url_test</code> with it:</p>
<div id="af7ccf1f" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>url_test <span class="op">=</span> mainpage.select(<span class="st">".article-listing a"</span>)[<span class="dv">0</span>].get(<span class="st">"href"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We have our first thesis URL:</p>
<div id="3caf78ec" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(url_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>https://trace.tennessee.edu/utk_graddiss/8076</code></pre>
</div>
</div>
</section>
<section id="send-request-to-test-url" class="level3">
<h3 class="anchored" data-anchor-id="send-request-to-test-url">Send request to test URL</h3>
<p>Now that we have the URL for the first dissertation information page, we want to extract the date, major, and advisor for that dissertation.</p>
<p>The first thing to do—as we did earlier with the database site—is to send a request to that page. Let’s assign it to a new object that we will call <code>r_test</code>:</p>
<div id="1e938a2f" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>r_test <span class="op">=</span> requests.get(url_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we can parse it with Beautiful Soup (as we did before). Let’s create a <code>dissertpage_test</code> object:</p>
<div id="20a91168" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>dissertpage_test <span class="op">=</span> BeautifulSoup(r_test.content, <span class="st">"html.parser"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="get-data-for-test-url" class="level3">
<h3 class="anchored" data-anchor-id="get-data-for-test-url">Get data for test URL</h3>
<p>It is time to extract the publication date, major, and advisor for our test URL.</p>
<p>Let’s start with the date. Thanks to the <a href="https://selectorgadget.com/">SelectorGadget</a>, following <a href="#identify-the-relevant-html-markers">the method we saw earlier</a>, we can see that we now need elements marked by <code>#publication_date p</code>.</p>
<p>We can use <code>select</code> as we did earlier:</p>
<div id="e105b0d4" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>dissertpage_test.select(<span class="st">"#publication_date p"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>[&lt;p&gt;5-2023&lt;/p&gt;]</code></pre>
</div>
</div>
<p>Notice the square brackets around our result: this is import. It shows us that we have a ResultSet (a list of results specific to Beautiful Soup). This is because <code>select</code> returns all the results. Here, we have a single result, but the format is still list-like. Before we can go further, we need to index the value out of it:</p>
<div id="35866822" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>dissertpage_test.select(<span class="st">"#publication_date p"</span>)[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>&lt;p&gt;5-2023&lt;/p&gt;</code></pre>
</div>
</div>
<p>We can now get the text out of this paragraph with the <code>text</code> attribute:</p>
<div id="c38045ec" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>dissertpage_test.select(<span class="st">"#publication_date p"</span>)[<span class="dv">0</span>].text</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>'5-2023'</code></pre>
</div>
</div>
<p>We could save it in a variable <code>date_test</code>:</p>
<div id="46d1153e" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>date_test <span class="op">=</span> dissertpage_test.select(<span class="st">"#publication_date p"</span>)[<span class="dv">0</span>].text</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="exo">
<div class="yourturn">
<p>Your turn:</p>
</div>
<p>Get the major and advisor for our test URL.</p>
</div>
</section>
</section>
<section id="full-run" class="level2">
<h2 class="anchored" data-anchor-id="full-run">Full run</h2>
<p>Once everything is working for a test site, we can do some bulk scraping.</p>
<section id="extract-all-urls" class="level3">
<h3 class="anchored" data-anchor-id="extract-all-urls">Extract all URLs</h3>
<p>We already know how to get the 100 dissertations links from the main page: <code>mainpage.select(".article-listing a")</code>. Let’s assign it to a variable:</p>
<div id="8802e149" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>dissertlinks <span class="op">=</span> mainpage.select(<span class="st">".article-listing a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This ResultSet is an <a href="https://docs.python.org/3/glossary.html#term-iterable">iterable</a>, meaning that it can be used in a loop.</p>
<p>Let’s write a loop to extract all the URLs from this ResultSet of links:</p>
<div id="f6e0afa2" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>urls <span class="op">=</span> []  <span class="co"># We create an empty list before filling it during the loop</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> link <span class="kw">in</span> dissertlinks:</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    urls.append(link.get(<span class="st">"href"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s see our first 5 URLs:</p>
<div id="45c347f6" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>urls[:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>['https://trace.tennessee.edu/utk_graddiss/8076',
 'https://trace.tennessee.edu/utk_graddiss/9158',
 'https://trace.tennessee.edu/utk_graddiss/8080',
 'https://trace.tennessee.edu/utk_graddiss/8086',
 'https://trace.tennessee.edu/utk_graddiss/8078']</code></pre>
</div>
</div>
</section>
<section id="extract-data-from-each-page" class="level3">
<h3 class="anchored" data-anchor-id="extract-data-from-each-page">Extract data from each page</h3>
<p>For each element of <code>urls</code> (i.e.&nbsp;for each dissertation URL), we can now get our information.</p>
<div id="cf89c99c" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>ls <span class="op">=</span> []                                            <span class="co"># Create an empty list</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> url <span class="kw">in</span> urls:                                   <span class="co"># For each element of our list of sites</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> requests.get(url)                                     <span class="co"># Send a request to the site</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    dissertpage <span class="op">=</span> BeautifulSoup(r.text, <span class="st">"html.parser"</span>)        <span class="co"># Parse the result</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    date <span class="op">=</span> dissertpage.select(<span class="st">"#publication_date p"</span>)[<span class="dv">0</span>].text  <span class="co"># Get the date</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    major <span class="op">=</span> dissertpage.select(<span class="st">"#department p"</span>)[<span class="dv">0</span>].text       <span class="co"># Get the major</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    advisor <span class="op">=</span> dissertpage.select(<span class="st">"#advisor1 p"</span>)[<span class="dv">0</span>].text            <span class="co"># Get the advisor</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    ls.append((date, major, advisor))                              <span class="co"># Store the results in the list</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="fl">0.1</span>)                                           <span class="co"># Add a delay at each iteration</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="note">
<p>Some sites will block requests if they are too frequent. Adding a little delay between requests is often a good idea.</p>
</div>
</section>
</section>
<section id="store-results-in-dataframe" class="level2">
<h2 class="anchored" data-anchor-id="store-results-in-dataframe">Store results in DataFrame</h2>
<p>A DataFrame would be a lot more convenient than a list to hold our results.</p>
<p>First, we create a list with the column names for our future DataFrame:</p>
<div id="eb5b3c93" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> [<span class="st">"Date"</span>, <span class="st">"Major"</span>, <span class="st">"Advisor"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we create our DataFrame:</p>
<div id="15342cc0" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(ls, columns<span class="op">=</span>cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="f805cdd9" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Major</th>
<th data-quarto-table-cell-role="th">Advisor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>5-2023</td>
<td>Life Sciences</td>
<td>Bode A. Olukolu</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>12-2023</td>
<td>Industrial Engineering</td>
<td>Hugh Medal</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5-2023</td>
<td>Nuclear Engineering</td>
<td>Erik Lukosi</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>5-2023</td>
<td>Energy Science and Engineering</td>
<td>Kyle R. Gluesenkamp</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5-2023</td>
<td>English</td>
<td>Margaret Lazarus Dean</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">95</td>
<td>8-2023</td>
<td>Educational Psychology and Research</td>
<td>Qi Sun</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">96</td>
<td>12-2023</td>
<td>Nuclear Engineering</td>
<td>Lawrence H. Heilbronn</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">97</td>
<td>5-2023</td>
<td>Geology</td>
<td>Bradley Thomson</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">98</td>
<td>5-2023</td>
<td>Natural Resources</td>
<td>Sharon R. Jean-Philippe</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">99</td>
<td>12-2023</td>
<td>Psychology</td>
<td>Greg Stuart</td>
</tr>
</tbody>
</table>

<p>100 rows × 3 columns</p>
</div>
</div>
</div>
</div>
</section>
<section id="save-results-to-file" class="level2">
<h2 class="anchored" data-anchor-id="save-results-to-file">Save results to file</h2>
<p>As a final step, we will save our data to a CSV file:</p>
<div id="077263a3" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>df.to_csv(<span class="st">'dissertations_data.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="note">
<p>The default <code>index=True</code> writes the row numbers. We are not writing these indices in our file by changing the value of this argument to <code>False</code>.</p>
</div>
<p>If you are using a Jupyter notebook or the <a href="https://en.wikipedia.org/wiki/IPython">IPython</a> shell, you can type <code>!ls</code> to see that the file is there and <code>!cat dissertations_data.csv</code> to print its content.</p>
<div class="note">
<p><code>!</code> is a magic command that allows to run Unix shell commands in a notebook or IPython shell.</p>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/dhsi-2024\.netlify\.app\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../about.html">
<p>About</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://etherpad.wikimedia.org/p/dhsi24" target="_blank">
<p>Live notes</p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>